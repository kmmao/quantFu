# QuantFu å¼€å‘æŒ‡å—

> å¿«é€Ÿå¯åŠ¨å’Œè°ƒè¯•æŒ‡å—

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹å¼1ï¼šä¸€é”®å¯åŠ¨å®Œæ•´ç¯å¢ƒï¼ˆæ¨èï¼‰

```bash
make dev-full
```

è¿™ä¼šè‡ªåŠ¨ï¼š
- âœ… æ¸…ç†æ—§çš„ç«¯å£å ç”¨è¿›ç¨‹ï¼ˆåªæ¸…ç†é¡¹ç›®ç›¸å…³è¿›ç¨‹ï¼Œä¸å½±å“å…¶ä»–ç¨‹åºï¼‰
- âœ… å¯åŠ¨ Supabase æ•°æ®åº“
- âœ… åå°å¯åŠ¨ FastAPI åç«¯ï¼ˆ8888ç«¯å£ï¼‰
- âœ… å‰å°å¯åŠ¨ Next.js å‰ç«¯ï¼ˆ3000ç«¯å£ï¼‰

### æ–¹å¼2ï¼šåˆ†åˆ«å¯åŠ¨

```bash
# å¯åŠ¨æ•°æ®åº“
make start

# å¯åŠ¨åç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
make dev-backend

# å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
make dev-frontend
```

---

## ğŸ“‹ æŸ¥çœ‹å®æ—¶æ—¥å¿—

### æ–¹æ³•1ï¼šä½¿ç”¨ Makefile å‘½ä»¤

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
make dev-logs-backend

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
make dev-logs-frontend

# åŒæ—¶æŸ¥çœ‹ä¸¤ä¸ªæ—¥å¿—
make dev-logs-both
```

### æ–¹æ³•2ï¼šä½¿ç”¨ tmux åˆ†å±è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
./watch-logs.sh
```

**æ•ˆæœï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ åç«¯æ—¥å¿— (backend.log)    â”‚
â”‚ INFO: Started server...      â”‚
â”‚ INFO: GET /api/kline...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”µ å‰ç«¯æ—¥å¿— (frontend.log)   â”‚
â”‚ âœ“ Compiled successfully      â”‚
â”‚ GET /chart 200 in 186ms      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¿«æ·é”®ï¼š**
- `Ctrl+B` ç„¶å `â†‘` æˆ– `â†“`ï¼šåˆ‡æ¢ä¸Šä¸‹çª—æ ¼
- `Ctrl+B` ç„¶å `D`ï¼šé€€å‡ºä½†ä¿æŒåå°è¿è¡Œ
- `Ctrl+C`ï¼šåœæ­¢æŸ¥çœ‹
- è¾“å…¥ `exit`ï¼šå®Œå…¨é€€å‡º

### æ–¹æ³•3ï¼šç›´æ¥ä½¿ç”¨ tail

```bash
# åç«¯æ—¥å¿—
tail -f backend/backend.log

# å‰ç«¯æ—¥å¿—
tail -f frontend/frontend.log
```

---

## ğŸ›‘ åœæ­¢æœåŠ¡

```bash
make dev-stop
```

è¿™ä¼šè‡ªåŠ¨ï¼š
- åœæ­¢åç«¯è¿›ç¨‹
- æ¸…ç†å ç”¨çš„ç«¯å£
- åœæ­¢æ•°æ®åº“å®¹å™¨

---

## ğŸ§¹ æ‰‹åŠ¨æ¸…ç†ç«¯å£å ç”¨

å¦‚æœé‡åˆ°ç«¯å£å†²çªï¼ˆæ¯”å¦‚ `EADDRINUSE`ï¼‰ï¼Œè¿è¡Œï¼š

```bash
make dev-clean-ports
```

**å®‰å…¨æ€§ä¿è¯ï¼š**
- âœ… åªæ¸…ç† Node.js å’Œ Python è¿›ç¨‹
- âœ… ä¸ä¼šè¯¯æ€å…¶ä»–ç¨‹åºï¼ˆå¦‚ Claudeã€æµè§ˆå™¨ç­‰ï¼‰
- âœ… æ¸…ç† 3000 ç«¯å£çš„ `next-server` è¿›ç¨‹
- âœ… æ¸…ç† 8888 ç«¯å£çš„ `uvicorn` è¿›ç¨‹

---

## ğŸ“‚ æ—¥å¿—æ–‡ä»¶ä½ç½®

| æœåŠ¡ | æ—¥å¿—è·¯å¾„ |
|------|---------|
| åç«¯ | `backend/backend.log` |
| å‰ç«¯ | `frontend/frontend.log` |
| æ•°æ®åº“ | `docker-compose logs -f` |

---

## ğŸ¯ æ¨èå¼€å‘æµç¨‹

### ç»ˆç«¯1ï¼šè¿è¡ŒæœåŠ¡
```bash
cd /path/to/quantFu
make dev-full
```

### ç»ˆç«¯2ï¼šæŸ¥çœ‹æ—¥å¿—
```bash
cd /path/to/quantFu
./watch-logs.sh
```

### ç»ˆç«¯3ï¼šæ‰§è¡Œå…¶ä»–å‘½ä»¤
```bash
# æ„å»ºå‰ç«¯
make frontend-build

# è¿è¡Œæµ‹è¯•
make test

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
make status
```

---

## ğŸ”— è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ |
|------|------|
| å‰ç«¯ | http://localhost:3000 |
| åç«¯ API æ–‡æ¡£ | http://localhost:8888/docs |
| Supabase Studio | http://localhost:3001 |
| PostgreSQL | localhost:5432 |

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šåç«¯å¯åŠ¨å¤±è´¥ - uvicorn: command not found

**ç—‡çŠ¶ï¼š**
```
(eval):1: command not found: uvicorn
```

**åŸå› ï¼š** Python è™šæ‹Ÿç¯å¢ƒæœªæ¿€æ´»

**è§£å†³ï¼š**
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰
make dev-backend

# æ–¹æ³•2ï¼šæ‰‹åŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
cd backend
source .venv/bin/activate
uvicorn main:app --reload --port 8888
```

**æ³¨æ„ï¼š** Makefile å·²ç»è‡ªåŠ¨å¤„ç†è™šæ‹Ÿç¯å¢ƒæ¿€æ´»ï¼Œä½¿ç”¨ `make dev-full` æˆ– `make dev-backend` æ— éœ€æ‰‹åŠ¨æ¿€æ´»ã€‚

### é—®é¢˜2ï¼šç«¯å£è¢«å ç”¨

**ç—‡çŠ¶ï¼š**
```
Error: listen EADDRINUSE: address already in use :::3000
```

**è§£å†³ï¼š**
```bash
make dev-clean-ports
make dev-full
```

### é—®é¢˜3ï¼šå‰ç«¯ 500 é”™è¯¯æˆ–"ç³»ç»ŸçŠ¶æ€æ£€æŸ¥å¤±è´¥"

**æ’æŸ¥æ­¥éª¤ï¼š**
1. æŸ¥çœ‹å‰ç«¯æ—¥å¿—ï¼š`make dev-logs-frontend`
2. æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š`make dev-logs-backend`
3. æ£€æŸ¥åç«¯æ˜¯å¦å¯åŠ¨ï¼š`curl http://localhost:8888/health`
4. æ£€æŸ¥æ•°æ®åº“è¿æ¥ï¼šè®¿é—® http://localhost:3001

### é—®é¢˜4ï¼šKçº¿å›¾è¶…æ—¶ (AbortError)

**å¯èƒ½åŸå› ï¼š**
- åç«¯å¤©å‹¤æœåŠ¡æœªå¯åŠ¨
- å¤©å‹¤è´¦å·è®¤è¯å¤±è´¥
- åˆçº¦ä»£ç æ ¼å¼é”™è¯¯ï¼ˆåº”ä¸º `SHFE.rb2505` æ ¼å¼ï¼‰

**æ’æŸ¥ï¼š**
```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
make dev-logs-backend

# æµ‹è¯•åç«¯æ¥å£
curl "http://localhost:8888/api/kline/SHFE.rb2505?duration=300&length=10"
```

### é—®é¢˜5ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# é‡å¯æ•°æ®åº“
make restart

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs -f postgres
```

---

## ğŸ“¦ å…¶ä»–å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# å®‰è£…ä¾èµ–
make install

# æ„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬
make frontend-build

# è¿è¡Œå‰ç«¯æµ‹è¯•
make frontend-test

# ä»£ç æ£€æŸ¥
make frontend-lint

# æ•°æ®åº“å¤‡ä»½
make db-backup

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
make status
```

---

## ğŸ’¡ å¼€å‘æŠ€å·§

### 1. çƒ­æ›´æ–°
å‰ç«¯å’Œåç«¯éƒ½æ”¯æŒçƒ­æ›´æ–°ï¼Œä¿®æ”¹ä»£ç åæ— éœ€é‡å¯ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚

**éœ€è¦é‡å¯çš„æƒ…å†µï¼š**
- ä¿®æ”¹ `.env` æ–‡ä»¶
- ä¿®æ”¹ `next.config.ts`
- å®‰è£…æ–°çš„ npm åŒ…
- ä¿®æ”¹ `tsconfig.json`

### 2. å¹¶è¡Œå¼€å‘
å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªåŠŸèƒ½ï¼š
```bash
# ç»ˆç«¯1: ä¸»æœåŠ¡
make dev-full

# ç»ˆç«¯2: æŸ¥çœ‹æ—¥å¿—
./watch-logs.sh

# ç»ˆç«¯3: è¿è¡Œæµ‹è¯•ï¼ˆwatch æ¨¡å¼ï¼‰
cd frontend && npm run test:watch
```

### 3. è°ƒè¯•æŠ€å·§
- å‰ç«¯ï¼šä½¿ç”¨æµè§ˆå™¨ DevTools (F12)
- åç«¯ï¼šæŸ¥çœ‹ `backend/backend.log`
- æ•°æ®åº“ï¼šä½¿ç”¨ Supabase Studio (http://localhost:3001)

---

## ğŸ“ æœ€è¿‘æ›´æ–°

### 2024-12-22
- âœ… æ·»åŠ  Kçº¿å›¾è¡¨æ‰‹åŠ¨è¾“å…¥åˆçº¦åŠŸèƒ½
- âœ… æ–°å¢æ™ºèƒ½ç«¯å£æ¸…ç†ï¼ˆä¸å½±å“ Claude ç­‰å…¶ä»–è¿›ç¨‹ï¼‰
- âœ… æ·»åŠ æ—¥å¿—æŸ¥çœ‹å‘½ä»¤å’Œ tmux åˆ†å±è„šæœ¬
- âœ… æ”¹è¿›å¯åŠ¨æµç¨‹ï¼Œè‡ªåŠ¨æ˜¾ç¤ºæ—¥å¿—è·¯å¾„

---

**é—®é¢˜åé¦ˆï¼š** é‡åˆ°é—®é¢˜è¯·æŸ¥çœ‹æ—¥å¿—æˆ–æ issue
